using System.Reflection;
using Crpg.Module.Api.Models.Characters;
using Crpg.Module.Api.Models.Items;
using Crpg.Module.Common;
using Crpg.Module.Common.Network;
using TaleWorlds.Core;
using TaleWorlds.Library;
using TaleWorlds.Localization;
using TaleWorlds.MountAndBlade;
using TaleWorlds.ObjectSystem;
using TaleWorlds.PlayerServices;

namespace Crpg.Module.Battle;

internal class CrpgBattleSpawningBehavior : SpawningBehaviorBase
{
    private const float TotalSpawnDuration = 30f;
    private const float CavalrySpawnDelay = 10f;
    private readonly CrpgConstants _constants;
    private readonly MultiplayerRoundController? _roundController;
    private readonly HashSet<PlayerId> _notifiedPlayersAboutDelayedSpawn;
    private MissionTimer? _spawnTimer;
    private MissionTimer? _cavalrySpawnDelay;
    private bool _botsSpawned;
    private int _bannerCounter = 14;
    private int _bannerProg = 0;

    public CrpgBattleSpawningBehavior(CrpgConstants constants, MultiplayerRoundController? roundController)
    {
        _constants = constants;
        _roundController = roundController;
        _notifiedPlayersAboutDelayedSpawn = new HashSet<PlayerId>();
    }

    public override void Initialize(SpawnComponent spawnComponent)
    {
        base.Initialize(spawnComponent);
        if (_roundController != null)
        {
            _roundController.OnPreparationEnded += RequestStartSpawnSession;
            _roundController.OnRoundEnding += RequestStopSpawnSession;
        }
    }

    public override void Clear()
    {
        base.Clear();
        if (_roundController != null)
        {
            _roundController.OnPreparationEnded -= RequestStartSpawnSession;
            _roundController.OnRoundEnding -= RequestStopSpawnSession;
        }
    }

    public override void OnTick(float dt)
    {
        if ((IsSpawningEnabled && IsRoundInProgress()) || _roundController == null)
        {
            SpawnAgents();
        }
    }

    public override void RequestStartSpawnSession()
    {
        base.RequestStartSpawnSession();
        _botsSpawned = false;
        _spawnTimer = new MissionTimer(TotalSpawnDuration); // Limit spawning for 30 seconds.
        _cavalrySpawnDelay = new MissionTimer(CavalrySpawnDelay); // Cav will spawn 6 seconds later.
        ResetSpawnTeams();
    }

    public override bool AllowEarlyAgentVisualsDespawning(MissionPeer missionPeer)
    {
        return false;
    }

    public bool SpawnDelayEnded()
    {
        return _cavalrySpawnDelay != null && _cavalrySpawnDelay!.Check();
    }

    protected override bool IsRoundInProgress()
    {
        return _roundController?.IsRoundInProgress ?? false;
    }

    protected override void SpawnAgents()
    {
        if (_roundController != null && _spawnTimer!.Check())
        {
            return;
        }

        if (!_botsSpawned || _roundController == null)
        {
            SpawnBotAgents();
            _botsSpawned = true;
        }

        SpawnPeerAgents();
    }

    private void ResetSpawnTeams()
    {
        foreach (NetworkCommunicator networkPeer in GameNetwork.NetworkPeers)
        {
            var crpgRepresentative = networkPeer.GetComponent<CrpgRepresentative>();
            if (crpgRepresentative != null)
            {
                crpgRepresentative.SpawnTeamThisRound = null;
            }
        }

        _notifiedPlayersAboutDelayedSpawn.Clear();
    }

    private void SpawnBotAgents()
    {
        BasicCultureObject cultureTeam1 = MBObjectManager.Instance.GetObject<BasicCultureObject>(MultiplayerOptions.OptionType.CultureTeam1.GetStrValue());
        BasicCultureObject cultureTeam2 = MBObjectManager.Instance.GetObject<BasicCultureObject>(MultiplayerOptions.OptionType.CultureTeam2.GetStrValue());
        int botsTeam1 = MultiplayerOptions.OptionType.NumberOfBotsTeam1.GetIntValue();
        int botsTeam2 = MultiplayerOptions.OptionType.NumberOfBotsTeam2.GetIntValue();

        if (botsTeam1 <= 0 && botsTeam2 <= 0)
        {
            return;
        }

        string[] bannerList = {
            "1.2.40.787.787.764.776.1.0.0.316.83.83.691.-693.760.771.1.0.-181.505.111.111.520.-256.760.734.1.0.-181",
            "11.116.116.1368.1836.787.750.1.0.-90.111.141.116.486.525.749.694.1.1.8.500.141.116.1181.959.652.496.0.1.-135.510.141.116.1054.188.602.451.0.1.-182.510.116.116.1054.188.658.431.0.1.-182.510.141.116.348.154.1281.437.0.1.-169.510.141.116.115.148.1154.625.0.1.-187.510.141.116.115.148.1058.803.0.1.-212.510.141.116.115.148.898.956.0.1.-230.510.141.116.106.148.692.1018.0.1.-261.510.116.116.291.406.325.903.0.1.-194.510.116.116.291.227.252.935.0.1.-196.510.116.116.291.406.1148.295.0.1.-266.510.116.116.1323.2397.192.636.0.1.-272.510.116.116.1105.2802.218.678.0.1.-269.510.116.116.531.1349.1090.81.0.1.-269",
            "27.142.22.3000.3000.764.764.1.0.0.133.35.116.609.609.764.764.1.0.0",
            "33.126.126.7353.7304.786.1576.1.0.-30.301.40.116.290.440.764.764.1.1.-45.301.40.116.290.440.764.764.1.1.45.510.40.40.400.250.764.814.1.1.90.510.40.40.250.200.764.764.1.1.0.510.132.132.240.150.764.764.1.1.0.510.132.132.390.200.764.814.1.1.90",
            "11.116.116.1368.1836.787.750.1.0.-90.111.141.116.486.525.749.694.1.1.8.500.141.116.1181.959.652.496.0.1.-135.510.141.116.1054.188.602.451.0.1.-182.510.116.116.1054.188.658.431.0.1.-182.510.141.116.348.154.1281.437.0.1.-169.510.141.116.115.148.1154.625.0.1.-187.510.141.116.115.148.1058.803.0.1.-212.510.141.116.115.148.898.956.0.1.-230.510.141.116.106.148.692.1018.0.1.-261.510.116.116.291.406.325.903.0.1.-194.510.116.116.291.227.252.935.0.1.-196.510.116.116.291.406.1148.295.0.1.-266.510.116.116.1323.2397.192.636.0.1.-272.510.116.116.1105.2802.218.678.0.1.-269.510.116.116.531.1349.1090.81.0.1.-269",
            "11.116.116.1368.1836.787.750.1.0.-90.111.141.116.486.525.749.694.1.1.8.500.141.116.1181.959.652.496.0.1.-135.510.141.116.1054.188.602.451.0.1.-182.510.116.116.1054.188.658.431.0.1.-182.510.141.116.348.154.1281.437.0.1.-169.510.141.116.115.148.1154.625.0.1.-187.510.141.116.115.148.1058.803.0.1.-212.510.141.116.115.148.898.956.0.1.-230.510.141.116.106.148.692.1018.0.1.-261.510.116.116.291.406.325.903.0.1.-194.510.116.116.291.227.252.935.0.1.-196.510.116.116.291.406.1148.295.0.1.-266.510.116.116.1323.2397.192.636.0.1.-272.510.116.116.1105.2802.218.678.0.1.-269.510.116.116.531.1349.1090.81.0.1.-269",
            "11.138.138.1612.4171.2120.973.1.0.87.424.132.116.240.240.780.914.1.0.0.424.132.116.240.240.664.664.1.0.0.424.132.116.240.240.904.664.1.0.0",
            "27.142.22.3000.3000.764.764.1.0.0.133.35.116.609.609.764.764.1.0.0",
            "14.128.142.1583.1651.764.764.1.0.0.522.143.116.1836.1724.764.764.1.0.0",
            "33.127.138.887.1829.755.765.1.0.180.428.138.127.711.711.608.734.1.0.-90.428.138.127.711.711.909.722.1.0.90.503.40.138.372.372.756.476.1.0.0.503.3.116.372.372.760.1009.1.0.0.428.127.138.711.711.763.1035.1.1.0.428.138.127.711.711.767.442.1.0.180.407.16.13.314.314.758.472.1.1.0.410.149.13.314.314.756.1009.1.1.0.428.138.127.237.237.642.746.1.0.-90.428.138.127.237.237.887.742.1.0.-270.406.127.138.237.237.758.746.1.0.-270",
            "11.12.6.1836.1836.766.788.1.0.-30.340.144.116.279.279.765.486.1.0.0.340.144.116.380.380.765.486.1.0.0.302.19.116.541.602.767.955.1.0.89.103.144.116.432.466.754.773.1.0.0.503.144.116.163.163.785.1015.1.0.179.406.144.116.133.133.785.1019.1.0.0.209.129.116.103.103.895.1053.1.0.282.209.129.116.103.103.684.1059.1.0.66.209.129.116.103.103.698.1091.1.0.94.209.129.116.103.103.654.1093.1.0.94.209.129.116.103.103.656.1111.1.0.94.209.129.116.103.103.887.1075.1.0.243.209.129.116.103.103.917.1077.1.0.264.209.129.116.103.103.905.1125.1.0.256.209.129.116.103.103.728.1109.1.0.128.209.129.116.103.103.767.1127.1.0.128.209.129.116.103.103.690.1123.1.0.128.209.129.116.103.103.857.1091.1.0.240.209.129.116.103.103.829.1113.1.0.240.423.145.116.148.136.785.1017.1.0.179.423.145.116.183.168.783.1013.1.0.179.503.36.116.44.40.532.951.1.0.179.506.148.116.38.30.560.952.1.0.179.506.148.116.38.30.577.952.1.0.179.506.148.116.38.30.594.952.1.0.179.506.148.116.38.30.611.952.1.0.179",
            "30.82.116.1836.1836.768.788.1.0.-30.203.82.116.864.864.768.788.1.1.0",
            "1.4.131.1836.1836.768.788.1.0.-30.503.61.123.513.402.764.764.1.0.0.506.139.92.314.330.764.739.1.0.90.506.139.139.336.330.764.814.1.0.90.503.99.99.222.111.764.839.1.0.0.503.149.149.130.102.764.805.1.0.0.510.116.123.206.34.763.849.1.0.0.503.116.123.23.25.744.813.1.0.-16.503.116.123.23.25.784.814.1.0.-16.506.149.149.114.118.667.733.1.0.135.503.124.124.40.35.684.719.1.0.180.506.149.149.114.118.861.732.1.1.224.503.124.124.40.35.844.719.1.0.180.340.143.124.300.300.764.542.1.1.0",
            "1.116.143.1967.1836.750.811.1.0.-30.133.143.116.323.323.763.726.1.0.-1.202.116.143.323.323.889.895.1.0.51.202.143.116.323.323.602.576.1.0.233",
            "11.145.145.2518.1881.764.764.1.0.0.504.40.40.220.475.764.904.1.0.0.504.40.40.220.475.764.624.1.1.180.504.40.40.220.475.904.764.1.1.90.504.40.40.220.475.624.764.1.0.270.504.145.145.300.135.1009.764.0.1.90.504.145.145.300.135.519.764.0.1.-90.504.145.145.300.135.764.518.0.1.-180.504.145.145.300.135.764.1009.0.1.0",
            "11.8.8.1450.1683.776.770.1.0.0.505.132.0.1436.1933.769.769.1.1.269.510.48.48.560.165.775.842.1.0.-90.500.116.116.-135.119.823.729.1.0.30.500.116.116.-61.63.879.748.1.0.30.500.116.116.-61.63.811.787.1.0.30.416.45.116.99.129.840.758.1.0.210.503.45.116.130.117.822.731.1.0.30.503.45.45.57.53.878.747.1.0.30.503.45.45.57.53.812.786.1.0.30.505.45.45.46.35.858.790.1.0.30.509.116.116.42.31.863.743.1.1.30.503.116.116.29.22.856.743.1.1.30.503.116.116.30.21.871.746.1.1.30.509.116.116.42.31.815.771.1.0.30.503.116.116.29.22.819.764.1.0.30.503.116.116.30.21.812.779.1.0.30.514.116.116.24.28.852.779.1.0.210.503.48.48.79.93.775.566.1.0.-90.504.48.48.89.205.775.489.1.0.0.510.48.48.69.45.775.627.1.0.0.510.116.116.37.53.777.644.1.0.0.510.116.116.23.19.781.775.1.0.-82.510.116.116.23.19.882.715.1.1.141.427.116.116.-15.8.837.795.1.1.169.427.116.116.-15.8.873.775.1.0.251.500.116.116.-135.119.866.864.1.0.27.500.116.116.-61.63.921.885.1.0.27.500.116.116.-61.63.852.922.1.0.27.416.45.116.99.129.882.894.1.0.207.503.45.116.130.117.866.866.1.0.27.503.45.45.57.53.921.885.1.0.27.503.45.45.57.53.853.921.1.0.27.505.45.45.46.35.899.926.1.0.27.509.116.116.42.31.906.880.1.1.27.503.116.116.29.22.899.879.1.1.27.503.116.116.30.21.914.883.1.1.27.509.116.116.42.31.857.906.1.0.27.503.116.116.29.22.861.899.1.0.27.503.116.116.30.21.854.913.1.0.27.514.116.116.24.28.893.915.1.0.207.510.116.116.23.19.823.908.1.0.-85.510.116.116.23.19.927.853.1.1.138.427.116.116.-15.8.877.931.1.1.166.427.116.116.-15.8.915.912.1.0.248.500.116.116.-135.119.848.987.1.0.12.500.116.116.-61.63.896.1022.1.0.12.500.116.116.-61.63.819.1039.1.0.12.416.45.116.99.129.856.1020.1.0.192.503.45.116.130.117.847.989.1.0.12.503.45.45.57.53.896.1022.1.0.12.503.45.45.57.53.821.1038.1.0.12.505.45.45.46.35.864.1056.1.0.12.509.116.116.42.31.882.1013.1.1.12.503.116.116.29.22.876.1010.1.1.12.503.116.116.30.21.890.1018.1.1.12.509.116.116.42.31.828.1025.1.0.12.503.116.116.29.22.834.1019.1.0.12.503.116.116.30.21.823.1031.1.0.12.514.116.116.24.28.861.1043.1.0.192.510.116.116.377.28.805.833.1.1.97.510.116.116.23.19.795.1018.1.0.-100.510.116.116.23.19.909.992.1.1.123.427.116.116.-15.8.842.1054.1.1.151.427.116.116.-15.8.883.1046.1.0.233.500.116.116.-139.123.778.851.1.0.13.500.116.116.-63.65.828.886.1.0.13.500.116.116.-63.65.749.904.1.0.13.416.45.116.103.133.786.884.1.0.193.503.45.116.134.121.777.853.1.0.13.503.45.45.59.55.827.886.1.0.13.503.45.45.59.55.750.904.1.0.13.505.45.45.47.36.795.921.1.0.13.509.116.116.44.32.814.877.1.1.13.503.116.116.30.22.807.874.1.1.13.503.116.116.31.22.821.882.1.1.13.509.116.116.44.32.758.890.1.0.13.503.116.116.30.22.764.884.1.0.13.503.116.116.31.22.753.897.1.0.13.514.116.116.25.29.792.908.1.0.193.510.116.116.24.19.724.884.1.0.-99.510.116.116.24.19.841.855.1.1.124.427.116.116.-15.8.772.920.1.1.152.427.116.116.-15.8.814.911.1.0.234.500.116.116.-139.123.637.879.1.0.-21.500.116.116.-63.65.658.937.1.0.-21.500.116.116.-63.65.583.907.1.0.-21.416.45.116.103.133.625.912.1.0.158.503.45.116.134.121.635.881.1.0.-22.503.45.45.59.55.658.936.1.0.-22.503.45.45.59.55.584.907.1.0.-22.505.45.45.47.36.612.947.1.0.-22.509.116.116.44.32.652.921.1.1.-22.503.116.116.30.22.648.915.1.1.-22.503.116.116.31.22.655.929.1.1.-22.509.116.116.44.32.598.901.1.0.-22.503.116.116.30.22.607.899.1.0.-22.503.116.116.31.22.591.903.1.0.-22.514.116.116.25.29.616.935.1.0.158.510.116.116.24.19.574.876.1.0.-133.510.116.116.24.19.687.919.1.1.90.427.116.116.-15.8.593.934.1.1.117.510.116.116.309.23.709.783.1.1.66.427.116.116.-15.8.633.950.1.0.199.500.116.116.-147.131.716.758.1.0.-17.510.116.116.235.24.777.763.1.1.90.500.116.116.-67.69.744.817.1.0.-17.500.116.116.-67.69.661.792.1.0.-17.416.45.116.109.142.706.793.1.0.163.503.45.116.142.128.714.760.1.0.-17.503.45.45.62.58.743.816.1.0.-17.503.45.45.62.58.663.792.1.0.-17.505.45.45.50.39.695.832.1.0.-17.509.116.116.46.34.735.801.1.1.-17.503.116.116.32.24.730.795.1.1.-17.503.116.116.33.23.740.809.1.1.-17.509.116.116.46.34.677.784.1.0.-17.503.116.116.32.24.686.781.1.0.-17.503.116.116.33.23.669.787.1.0.-17.514.116.116.27.30.699.818.1.0.163.510.116.116.25.21.649.760.1.0.-128.510.116.116.25.21.772.795.1.1.94.427.116.116.-16.9.674.819.1.1.122.427.116.116.-16.9.718.833.1.0.204.500.116.116.-122.108.724.918.1.0.8.500.116.116.-55.57.765.952.1.0.8.500.116.116.-55.57.694.963.1.0.8.416.45.116.90.117.729.948.1.0.188.503.45.116.118.106.723.920.1.0.8.503.45.45.51.48.764.952.1.0.8.503.45.45.51.48.696.962.1.0.8.505.45.45.41.32.733.981.1.0.8.509.116.116.38.28.753.943.1.1.8.503.116.116.27.20.747.940.1.1.8.503.11",
            "27.116.35.1856.2075.768.788.0.0.-90.505.35.116.0.0.764.764.0.0.0",
            "11.138.19.1836.1836.768.788.1.0.-30.424.132.116.240.240.780.914.1.0.0.424.132.116.240.240.664.664.1.0.0.424.132.116.240.240.904.664.1.0.0",
            "11.8.100.1836.1836.764.764.1.0.-30.337.132.132.299.319.764.764.0.0.0",
            "1.149.149.3345.1846.774.1509.1.0.88.514.131.149.254.238.764.718.1.0.0.309.131.149.902.845.364.764.0.0.-15.309.131.149.902.845.1164.764.0.1.15.421.131.149.900.900.764.752.0.1.90",
            "2.0.7.2700.2700.0.0.1.0.0.424.12.5.240.240.764.994.1.0.0.424.12.5.240.240.884.774.1.0.0.424.12.5.240.240.644.774.1.0.0.424.12.5.240.240.954.544.1.0.0.424.12.5.240.240.763.544.1.0.0.424.12.5.240.240.574.544.1.0.0",
            "25.40.40.2724.2000.295.714.0.0.0.510.14.14.600.500.764.764.0.0.90.510.14.14.600.500.764.764.0.0.0.504.14.14.175.100.764.1019.0.0.0.504.14.14.175.100.764.509.0.0.180.504.14.14.175.100.1019.764.0.0.90.504.14.14.175.100.509.764.0.0.-90",
            "28.116.128.1919.1935.654.782.1.0.45.419.127.127.1825.1628.-739.2347.0.0.0",
            "28.116.128.1919.1935.654.782.1.0.45.419.127.127.1825.1628.-739.2347.0.0.0",
            "17.116.0.1510.1132.768.768.1.0.0.503.116.0.676.676.764.764.1.0.0.500.116.7.652.652.764.764.1.0.0.528.0.149.393.393.692.765.1.0.0.510.0.149.354.175.921.760.1.0.-90.304.19.116.258.550.811.835.1.1.267.510.91.116.373.55.690.829.1.1.-3.108.84.116.645.553.766.769.1.1.0.510.91.91.186.55.689.829.1.1.-3.434.12.149.101.96.865.981.1.1.0.434.12.149.101.96.679.981.1.0.0.448.0.116.233.96.771.1004.1.1.0.525.142.116.86.86.714.564.1.0.0.525.84.116.86.86.809.560.1.0.0",
            "28.116.128.1919.1935.638.778.1.0.45.419.143.127.530.528.647.778.0.0.0.424.143.127.270.147.886.776.0.0.-91.424.143.127.270.147.646.546.0.0.0.424.143.127.270.147.412.777.0.0.-271.424.143.127.270.147.648.1015.0.0.-180.318.143.116.348.339.646.809.1.0.0.101.116.127.186.193.645.792.0.0.0",
            "2.121.6.1826.1836.769.788.1.0.-30.139.143.116.603.603.762.771.1.0.0",
            "11.116.116.1836.1836.768.788.1.0.-30.503.98.116.1850.1850.764.764.1.1.0.521.98.116.2000.2000.764.764.1.1.18.503.23.99.1700.1700.764.764.1.1.0.521.23.99.1850.1850.764.764.1.1.0.503.27.25.1550.1550.764.764.1.1.0.521.27.25.1700.1700.764.764.1.1.18.503.128.128.1400.1400.764.764.1.1.0.521.35.35.1550.1550.764.764.1.1.0.521.14.84.541.518.764.764.1.1.18.521.14.84.723.634.764.764.1.1.0.521.14.84.614.536.764.764.1.1.0.521.14.84.509.444.764.764.1.1.0.520.84.14.447.438.762.762.1.1.0.519.84.14.401.383.764.764.1.1.0.519.84.14.385.377.764.764.1.1.23.509.84.14.322.316.764.764.1.1.22.503.127.14.317.311.764.764.1.1.24",
            "11.116.116.1836.1836.768.788.1.0.-30.206.86.116.299.299.656.792.1.0.63.206.86.116.299.299.871.791.1.1.297.514.86.116.299.299.764.764.1.1.0.138.127.116.140.140.764.764.1.0.0",
            "2.130.116.1836.1836.756.791.1.0.0.213.126.2.1503.1503.927.779.1.0.0.500.140.116.481.481.1169.466.1.0.0.527.140.116.467.467.656.458.1.0.0.527.140.116.501.501.672.1011.1.0.0.526.140.116.479.479.1192.999.1.0.0.315.60.116.245.245.264.1123.1.0.-90.305.60.116.245.245.264.861.1.0.-90.306.60.116.245.245.264.628.1.0.-90.301.60.116.245.245.264.380.1.0.-90",
            "11.88.88.1836.1836.768.788.1.0.0.506.25.25.861.616.765.784.0.1.0.506.25.25.783.616.765.756.0.1.0.503.129.129.170.212.898.805.0.1.-7.503.126.126.182.263.715.963.0.1.-115.503.129.129.186.266.659.678.0.1.-21",
            "2.119.121.1449.1528.763.766.1.0.90.213.82.116.515.515.771.753.1.1.0.324.101.116.384.384.768.911.1.1.0.157.128.116.835.835.796.849.1.0.0",
            "11.116.116.3000.3000.764.764.1.0.0.503.116.116.1.1.3764.-2236.0.0.69.503.40.3.59.90.810.704.0.0.-66.503.116.3.48.69.808.707.0.0.-66.504.40.116.139.350.764.926.0.0.0.503.40.2.116.47.830.1055.0.0.-4.503.116.2.57.24.852.1052.0.0.-9.503.40.2.116.47.698.1055.0.0.4.503.116.2.57.24.676.1052.0.0.9.503.40.2.116.41.790.1050.0.0.-4.503.116.2.42.22.818.1050.0.0.-9.503.40.2.116.41.738.1050.0.0.4.503.116.2.42.22.710.1050.0.0.9.503.40.2.98.43.764.1051.0.0.0.503.116.2.90.43.764.1057.0.0.0.505.116.2.21.475.764.1070.0.0.90.503.116.2.110.110.832.979.0.0.0.505.116.2.110.135.830.914.0.0.2.503.116.2.110.110.696.979.0.0.0.505.116.2.110.135.698.914.0.0.-2.504.116.3.41.69.796.736.0.0.-90.505.116.3.74.65.834.704.0.0.-151.503.40.3.124.130.806.613.0.0.0.503.116.3.142.103.794.626.0.0.27.505.116.3.142.126.808.570.0.0.21.503.40.3.32.62.877.602.0.0.-21.503.116.3.32.86.883.603.0.0.-19.503.40.3.32.55.831.637.0.0.26.503.116.3.32.41.825.645.0.0.-21.505.116.3.32.41.814.628.0.0.-55.503.40.3.24.39.840.599.0.0.-19.503.116.3.24.39.845.599.0.0.-19.503.40.3.24.39.830.576.0.0.-12.503.116.3.24.39.827.576.0.0.-12.503.40.3.24.39.817.603.0.0.-36.503.116.3.24.39.814.607.0.0.-36.522.40.1.20.20.957.608.1.0.45.522.40.1.15.15.957.608.1.0.0.515.40.1.20.20.957.608.0.0.0.503.40.5.101.164.842.770.0.0.-116.503.116.5.76.97.820.757.0.0.-104.503.116.5.76.97.834.760.0.0.-104.503.116.145.76.97.858.786.0.0.-104.504.116.5.94.299.868.810.0.0.-90.427.116.5.76.81.898.794.0.0.-305.503.40.5.76.81.920.740.0.0.-104.503.116.5.76.81.920.732.0.0.-136.503.40.5.25.25.950.776.0.0.11.503.116.5.25.25.946.781.0.0.11.503.40.5.50.52.907.750.0.0.52.503.116.5.42.38.907.748.0.0.0.503.40.5.52.34.944.724.0.0.70.503.116.5.58.34.947.726.0.0.76.504.116.5.48.105.878.716.0.0.53.503.40.6.58.80.892.680.0.0.137.504.116.6.57.183.906.650.0.0.-46.503.116.6.41.80.884.686.0.0.124.503.40.6.58.34.892.672.0.0.103.503.116.6.56.30.890.674.0.0.98.505.40.6.8.46.876.716.0.0.112.504.116.6.32.53.879.726.0.0.88.503.40.6.58.34.938.650.0.0.67.503.116.6.66.34.942.652.0.0.70.503.40.6.54.30.906.634.0.0.93.503.116.6.54.26.909.636.0.0.93.503.40.0.55.79.806.769.0.0.-109.504.116.0.64.94.804.799.0.0.-87.503.116.0.49.69.807.770.0.0.-115.503.40.0.36.61.864.784.0.0.-139.503.116.0.36.68.865.780.0.0.-147.503.40.0.36.44.792.762.0.0.-33.503.116.0.34.60.789.773.0.0.-16.503.40.0.22.34.813.784.0.0.28.503.116.0.22.34.814.782.0.0.-10.504.116.0.46.54.816.796.0.0.-34.427.40.6.48.16.864.670.0.0.-87.503.40.6.48.30.856.704.0.0.66.503.116.6.28.28.855.699.0.0.66.503.116.6.28.28.849.707.0.0.66.503.116.6.28.28.852.704.0.0.66.516.145.145.1.1.764.764.0.0.69.503.40.3.59.90.718.704.0.0.66.503.116.3.48.69.720.707.0.0.66.504.116.3.41.69.732.736.0.0.90.505.116.3.74.65.694.704.0.0.151.503.40.3.124.130.722.613.0.0.0.503.116.3.142.103.734.626.0.0.-27.505.116.3.142.126.720.570.0.0.-21.503.40.3.32.62.651.602.0.0.21.503.116.3.32.86.645.603.0.0.19.503.40.3.32.55.697.637.0.0.-26.503.116.3.32.41.703.645.0.0.21.505.116.3.32.41.714.628.0.0.55.503.40.3.24.39.688.599.0.0.19.503.116.3.24.39.683.599.0.0.19.503.40.3.24.39.698.576.0.0.12.503.116.3.24.39.701.576.0.0.12.503.40.3.24.39.711.603.0.0.36.503.116.3.24.39.714.607.0.0.36.503.40.5.101.164.686.770.0.0.116.503.116.5.76.97.708.757.0.0.104.503.116.5.76.97.694.760.0.0.104.503.116.145.76.97.670.786.0.0.104.504.116.5.94.299.660.810.0.0.90.427.116.5.76.81.630.794.0.0.305.503.40.5.76.81.608.740.0.0.104.503.116.5.76.81.608.732.0.0.136.503.40.5.25.25.578.776.0.0.-11.503.116.5.25.25.582.781.0.0.-11.503.40.5.50.52.621.750.0.0.-52.503.116.5.42.38.621.748.0.0.0.503.40.5.52.34.584.724.0.0.-70.503.116.5.58.34.581.726.0.0.-76.504.116.5.48.105.650.716.0.0.-53.503.40.6.58.80.636.680.0.0.-137.504.116.6.57.183.622.650.0.0.46.503.116.6.41.80.644.686.0.0.-124.503.40.6.58.34.636.672.0.0.-103.503.116.6.56.30.638.674.0.0.-98.505.40.6.8.46.652.716.0.0.-112.504.116.6.32.53.649.726.0.0.-88.503.40.6.58.34.590.650.0.0.-67.503.116.6.66.34.586.652.0.0.-70.503.40.6.54.30.622.634.0.0.-93.503.116.6.54.26.619.636.0.0.-93.427.40.6.48.16.664.670.0.0.87.503.40.6.48.30.672.704.0.0.-66.503.116.6.28.28.673.699.0.0.-66.503.116.6.28.28.679.707.0.0.-66.503.116.6.28.28.676.704.0.0.-66.503.40.0.55.79.722.769.0.0.109.504.116.0.64.94.724.799.0.0.87.503.116.0.49.69.721.770.0.0.115.503.40.0.36.61.664.784.0.0.139.503.116.0.36.68.663.780.0.0.147.503.40.0.36.44.736.762.0.0.33.503.116.0.34.60.739.773.0.0.16.503.40.0.22.34.715.784.0.0.-28.503.116.0.22.34.714.782.0.0.10.504.116.0.46.54.712.796.0.0.34.503.40.7.36.64.791.656.0.0.-26.503.116.7.30.55.792.658.0.0.-21.504.116.7.35.55.799.664.0.0.-214.504.116.7.35.55.816.654.0.0.-219.504.40.9.7.118.793.584.0.0.-36.504.40.9.24.24.773.614.0.0.-52.503.40.9.24.45.808.550.0.0.-14.503.116.9.24.45.804.548.0.0.-14.503.40.9.24.32.796.564.0.0.-23.503.116.9.20.24.794.564.0.0.-40.504.116.9.20.24.792.573.0.0.-63.503.40.7.36.64.737.656.0.0.26.503.116.7.30.55.736.658.0.0.21.504.116.7.35.55.729.664.0.0.214.504.116.7.35.55.712.654.0.0.219.504.40.9.7.118.735.584.0.0.36.504.40.9.24.24.755.614.0.0.52.503.40.9.24.45.720.550.0.0.14.503.116.9.24.45.724.548.0.0.14.503.40.9.24.32.732.564.0.0.23.503.116.9.20.24.734.564.0.0.40.504.116.9.20.24.736.573.0.0.63.500.116.116.1.1.764.764.0.0.69.504.40.40.12.78.757.564.0.0.14.504.40.40.12.78.757.556.0.0.18.503.40.40.8.60.752.538.0.0.20.503.40.40.12.40.748.525.0.0.20.503.116.40.12.60.749.556.0.0.20.503.116.40.12.60.754.529.0.0.26.505.40.116.21.437.764.824.0.0.0.504.116.7.31.55.780.682.0.0.-214.504.116.7.31.55.748.682.0.0.214.504.40.40.12.78.771.564.0.0.-14.504.40.40.12.78.771.556.0.0.-18.503.40.40.8.60.776.538.0.0.-20.503.40.40.12.40.780.525.0.0.-20.503.116.40.12.60.779.556.0.0.-20.503.116.40.12.60.774.529.0.0.-26.503.40.116.16.55.764.592.0.0.0.503.40.116.14.55.764.582.0.0.0.515.40.1.20.20.764.424.0.0.0.522.40.1.15.15.764.424.1.0.0.522.40.1.20.20.764.424.1.0.45.522.40.1.20.20.822.474.1.0.45.515.40.1.20.20.822.474.0.0.0.522.40.1.15.15.822.474.1.0.0.522.40.1.20.20.706.474.1.0.45.515.40.1.20.20.706.474.0.0.0.522.40.1.15.15.706.474.1.0.0.522.40.1.20.20.908.550.1.0.45.522.40.1.15.15.908.550.1.0.0.515.40.1.20.20.908.550.0.0.0.515.40.1.20.20.620.550.0.0.0.522.40.1.15.15.620.550.1.0.0.522.40.1.20.20.620.550.1.0.45.522.40.1.20.20.571.608.1.0.45.522.40.1.15.15.571.608.1.0.0.515.40.1.20.20.571.608.0.0.0.503.40.1.24.50.764.472.0.0.180.216.116.1.42.50.764.474.0.0.180.503.40.1.50.18.764.494.0.0.0.503.116.1.16.24.764.480.0.0.180.503.40.1.12.20.764.480.0.0.180.503.116.1.34.12.764.498.0.0.0.503.40.1.34.10.764.500.0.0.0.503.40.1.16.34.787.476.0.0.-4.503.116.1.16.34.793.474.0.0.0.503.116.1.16.20.790.493.0.0.0.503.40.1.16.34.741.476.0.0.4.503.116.1.16.34.735.474.0.0.0.503.116.1.16.20.738.493.0.0.0.505.116.1.2.54.764.474.0.0.0.503.116.1.10.18.764.484.0.0.180.503.40.1.8.16.764.484.0.0.180.503.40.116.8.16.764.764.0.0.180",
            "11.116.116.3000.3000.764.764.1.0.0.503.116.116.1.1.3764.-2236.0.0.69.503.40.3.59.90.810.704.0.0.-66.503.116.3.48.69.808.707.0.0.-66.504.40.116.139.350.764.926.0.0.0.503.40.2.116.47.830.1055.0.0.-4.503.116.2.57.24.852.1052.0.0.-9.503.40.2.116.47.698.1055.0.0.4.503.116.2.57.24.676.1052.0.0.9.503.40.2.116.41.790.1050.0.0.-4.503.116.2.42.22.818.1050.0.0.-9.503.40.2.116.41.738.1050.0.0.4.503.116.2.42.22.710.1050.0.0.9.503.40.2.98.43.764.1051.0.0.0.503.116.2.90.43.764.1057.0.0.0.505.116.2.21.475.764.1070.0.0.90.503.116.2.110.110.832.979.0.0.0.505.116.2.110.135.830.914.0.0.2.503.116.2.110.110.696.979.0.0.0.505.116.2.110.135.698.914.0.0.-2.504.116.3.41.69.796.736.0.0.-90.505.116.3.74.65.834.704.0.0.-151.503.40.3.124.130.806.613.0.0.0.503.116.3.142.103.794.626.0.0.27.505.116.3.142.126.808.570.0.0.21.503.40.3.32.62.877.602.0.0.-21.503.116.3.32.86.883.603.0.0.-19.503.40.3.32.55.831.637.0.0.26.503.116.3.32.41.825.645.0.0.-21.505.116.3.32.41.814.628.0.0.-55.503.40.3.24.39.840.599.0.0.-19.503.116.3.24.39.845.599.0.0.-19.503.40.3.24.39.830.576.0.0.-12.503.116.3.24.39.827.576.0.0.-12.503.40.3.24.39.817.603.0.0.-36.503.116.3.24.39.814.607.0.0.-36.522.40.1.20.20.957.608.1.0.45.522.40.1.15.15.957.608.1.0.0.515.40.1.20.20.957.608.0.0.0.503.40.5.101.164.842.770.0.0.-116.503.116.5.76.97.820.757.0.0.-104.503.116.5.76.97.834.760.0.0.-104.503.116.145.76.97.858.786.0.0.-104.504.116.5.94.299.868.810.0.0.-90.427.116.5.76.81.898.794.0.0.-305.503.40.5.76.81.920.740.0.0.-104.503.116.5.76.81.920.732.0.0.-136.503.40.5.25.25.950.776.0.0.11.503.116.5.25.25.946.781.0.0.11.503.40.5.50.52.907.750.0.0.52.503.116.5.42.38.907.748.0.0.0.503.40.5.52.34.944.724.0.0.70.503.116.5.58.34.947.726.0.0.76.504.116.5.48.105.878.716.0.0.53.503.40.6.58.80.892.680.0.0.137.504.116.6.57.183.906.650.0.0.-46.503.116.6.41.80.884.686.0.0.124.503.40.6.58.34.892.672.0.0.103.503.116.6.56.30.890.674.0.0.98.505.40.6.8.46.876.716.0.0.112.504.116.6.32.53.879.726.0.0.88.503.40.6.58.34.938.650.0.0.67.503.116.6.66.34.942.652.0.0.70.503.40.6.54.30.906.634.0.0.93.503.116.6.54.26.909.636.0.0.93.503.40.0.55.79.806.769.0.0.-109.504.116.0.64.94.804.799.0.0.-87.503.116.0.49.69.807.770.0.0.-115.503.40.0.36.61.864.784.0.0.-139.503.116.0.36.68.865.780.0.0.-147.503.40.0.36.44.792.762.0.0.-33.503.116.0.34.60.789.773.0.0.-16.503.40.0.22.34.813.784.0.0.28.503.116.0.22.34.814.782.0.0.-10.504.116.0.46.54.816.796.0.0.-34.427.40.6.48.16.864.670.0.0.-87.503.40.6.48.30.856.704.0.0.66.503.116.6.28.28.855.699.0.0.66.503.116.6.28.28.849.707.0.0.66.503.116.6.28.28.852.704.0.0.66.516.145.145.1.1.764.764.0.0.69.503.40.3.59.90.718.704.0.0.66.503.116.3.48.69.720.707.0.0.66.504.116.3.41.69.732.736.0.0.90.505.116.3.74.65.694.704.0.0.151.503.40.3.124.130.722.613.0.0.0.503.116.3.142.103.734.626.0.0.-27.505.116.3.142.126.720.570.0.0.-21.503.40.3.32.62.651.602.0.0.21.503.116.3.32.86.645.603.0.0.19.503.40.3.32.55.697.637.0.0.-26.503.116.3.32.41.703.645.0.0.21.505.116.3.32.41.714.628.0.0.55.503.40.3.24.39.688.599.0.0.19.503.116.3.24.39.683.599.0.0.19.503.40.3.24.39.698.576.0.0.12.503.116.3.24.39.701.576.0.0.12.503.40.3.24.39.711.603.0.0.36.503.116.3.24.39.714.607.0.0.36.503.40.5.101.164.686.770.0.0.116.503.116.5.76.97.708.757.0.0.104.503.116.5.76.97.694.760.0.0.104.503.116.145.76.97.670.786.0.0.104.504.116.5.94.299.660.810.0.0.90.427.116.5.76.81.630.794.0.0.305.503.40.5.76.81.608.740.0.0.104.503.116.5.76.81.608.732.0.0.136.503.40.5.25.25.578.776.0.0.-11.503.116.5.25.25.582.781.0.0.-11.503.40.5.50.52.621.750.0.0.-52.503.116.5.42.38.621.748.0.0.0.503.40.5.52.34.584.724.0.0.-70.503.116.5.58.34.581.726.0.0.-76.504.116.5.48.105.650.716.0.0.-53.503.40.6.58.80.636.680.0.0.-137.504.116.6.57.183.622.650.0.0.46.503.116.6.41.80.644.686.0.0.-124.503.40.6.58.34.636.672.0.0.-103.503.116.6.56.30.638.674.0.0.-98.505.40.6.8.46.652.716.0.0.-112.504.116.6.32.53.649.726.0.0.-88.503.40.6.58.34.590.650.0.0.-67.503.116.6.66.34.586.652.0.0.-70.503.40.6.54.30.622.634.0.0.-93.503.116.6.54.26.619.636.0.0.-93.427.40.6.48.16.664.670.0.0.87.503.40.6.48.30.672.704.0.0.-66.503.116.6.28.28.673.699.0.0.-66.503.116.6.28.28.679.707.0.0.-66.503.116.6.28.28.676.704.0.0.-66.503.40.0.55.79.722.769.0.0.109.504.116.0.64.94.724.799.0.0.87.503.116.0.49.69.721.770.0.0.115.503.40.0.36.61.664.784.0.0.139.503.116.0.36.68.663.780.0.0.147.503.40.0.36.44.736.762.0.0.33.503.116.0.34.60.739.773.0.0.16.503.40.0.22.34.715.784.0.0.-28.503.116.0.22.34.714.782.0.0.10.504.116.0.46.54.712.796.0.0.34.503.40.7.36.64.791.656.0.0.-26.503.116.7.30.55.792.658.0.0.-21.504.116.7.35.55.799.664.0.0.-214.504.116.7.35.55.816.654.0.0.-219.504.40.9.7.118.793.584.0.0.-36.504.40.9.24.24.773.614.0.0.-52.503.40.9.24.45.808.550.0.0.-14.503.116.9.24.45.804.548.0.0.-14.503.40.9.24.32.796.564.0.0.-23.503.116.9.20.24.794.564.0.0.-40.504.116.9.20.24.792.573.0.0.-63.503.40.7.36.64.737.656.0.0.26.503.116.7.30.55.736.658.0.0.21.504.116.7.35.55.729.664.0.0.214.504.116.7.35.55.712.654.0.0.219.504.40.9.7.118.735.584.0.0.36.504.40.9.24.24.755.614.0.0.52.503.40.9.24.45.720.550.0.0.14.503.116.9.24.45.724.548.0.0.14.503.40.9.24.32.732.564.0.0.23.503.116.9.20.24.734.564.0.0.40.504.116.9.20.24.736.573.0.0.63.500.116.116.1.1.764.764.0.0.69.504.40.40.12.78.757.564.0.0.14.504.40.40.12.78.757.556.0.0.18.503.40.40.8.60.752.538.0.0.20.503.40.40.12.40.748.525.0.0.20.503.116.40.12.60.749.556.0.0.20.503.116.40.12.60.754.529.0.0.26.505.40.116.21.437.764.824.0.0.0.504.116.7.31.55.780.682.0.0.-214.504.116.7.31.55.748.682.0.0.214.504.40.40.12.78.771.564.0.0.-14.504.40.40.12.78.771.556.0.0.-18.503.40.40.8.60.776.538.0.0.-20.503.40.40.12.40.780.525.0.0.-20.503.116.40.12.60.779.556.0.0.-20.503.116.40.12.60.774.529.0.0.-26.503.40.116.16.55.764.592.0.0.0.503.40.116.14.55.764.582.0.0.0.515.40.1.20.20.764.424.0.0.0.522.40.1.15.15.764.424.1.0.0.522.40.1.20.20.764.424.1.0.45.522.40.1.20.20.822.474.1.0.45.515.40.1.20.20.822.474.0.0.0.522.40.1.15.15.822.474.1.0.0.522.40.1.20.20.706.474.1.0.45.515.40.1.20.20.706.474.0.0.0.522.40.1.15.15.706.474.1.0.0.522.40.1.20.20.908.550.1.0.45.522.40.1.15.15.908.550.1.0.0.515.40.1.20.20.908.550.0.0.0.515.40.1.20.20.620.550.0.0.0.522.40.1.15.15.620.550.1.0.0.522.40.1.20.20.620.550.1.0.45.522.40.1.20.20.571.608.1.0.45.522.40.1.15.15.571.608.1.0.0.515.40.1.20.20.571.608.0.0.0.503.40.1.24.50.764.472.0.0.180.216.116.1.42.50.764.474.0.0.180.503.40.1.50.18.764.494.0.0.0.503.116.1.16.24.764.480.0.0.180.503.40.1.12.20.764.480.0.0.180.503.116.1.34.12.764.498.0.0.0.503.40.1.34.10.764.500.0.0.0.503.40.1.16.34.787.476.0.0.-4.503.116.1.16.34.793.474.0.0.0.503.116.1.16.20.790.493.0.0.0.503.40.1.16.34.741.476.0.0.4.503.116.1.16.34.735.474.0.0.0.503.116.1.16.20.738.493.0.0.0.505.116.1.2.54.764.474.0.0.0.503.116.1.10.18.764.484.0.0.180.503.40.1.8.16.764.484.0.0.180.503.40.116.8.16.764.764.0.0.180",
            "11.83.19.2058.2058.658.865.1.0.-30.516.58.29.234.234.923.754.1.1.-53.427.58.29.402.402.662.769.1.1.-90",
            "30.116.116.1407.1104.771.765.1.0.0.212.110.110.355.446.762.673.1.0.0.212.110.110.478.252.765.744.1.0.0.207.110.110.-98.-146.817.843.1.0.-115.207.110.110.115.-151.703.848.1.0.-249.154.110.110.118.-127.734.866.1.0.143.154.110.110.-131.-80.794.866.1.0.201.210.110.110.294.-196.768.560.1.0.189.210.110.110.320.-265.680.632.1.0.182.210.110.110.368.-247.697.655.1.0.288.210.110.110.368.296.796.610.1.0.294.210.110.110.-331.296.863.630.1.0.207.210.110.110.-387.296.829.629.1.0.194.200.110.110.151.-217.875.721.1.0.-242.200.110.110.-144.-241.666.723.1.0.-113.200.110.110.-256.-178.631.684.1.0.-165.200.110.110.206.-204.905.681.1.0.-205.200.110.110.282.-204.868.641.1.0.-194.200.110.110.-279.-204.668.630.1.0.-158.200.110.110.-217.-204.726.570.1.0.-198.200.110.110.209.-204.797.567.1.0.-166.202.110.110.223.-326.656.643.1.0.-228.202.110.110.-206.-326.875.644.1.0.-140.202.110.110.-244.-300.834.566.1.0.-37.202.110.110.252.-289.697.560.1.0.31.200.110.110.-294.239.752.583.1.0.33.428.110.110.-314.292.760.964.1.0.-1.207.110.110.-177.164.767.882.1.0.15.513.110.110.-119.110.763.853.1.0.-173.202.110.110.-202.172.713.983.1.0.-42.202.110.110.-202.172.809.983.1.1.41",
            "11.128.128.5000.5000.768.788.1.0.0.510.116.116.730.865.764.626.0.1.0.510.116.116.1077.866.764.764.0.1.90.510.148.116.313.885.764.431.0.1.90",
            "11.4.19.2944.1836.768.788.1.0.-30.423.144.116.639.308.761.372.1.1.0.101.144.116.720.720.750.853.1.1.0",
            "11.127.146.1469.1131.784.775.1.0.0.505.140.140.1591.333.764.764.0.0.0.505.116.116.1591.277.764.764.0.0.0.503.146.140.600.600.764.764.0.0.0.503.116.116.550.550.764.764.0.0.0.503.127.116.515.515.764.764.0.0.0.503.116.116.450.450.764.764.1.0.0.510.127.116.467.420.764.764.0.0.90.510.127.116.467.420.764.764.0.0.0.510.127.116.467.420.764.764.0.0.45.510.127.116.467.420.764.764.0.0.-45.503.127.116.400.400.764.764.0.0.0.503.116.116.150.150.764.764.0.0.0.510.116.116.320.230.764.764.0.0.90.510.116.116.320.230.764.764.0.0.45.510.116.116.320.230.764.764.0.0.0.510.116.116.320.230.764.764.0.0.-45",
            "11.116.142.3840.2160.764.764.1.0.0.505.142.128.650.3000.764.758.1.0.60.514.40.7.209.157.706.580.0.0.23.514.40.7.158.118.815.586.0.0.-20.323.15.15.436.436.758.761.1.0.0.505.0.7.221.333.758.766.0.0.0.503.40.7.65.106.626.614.0.0.-8.330.15.15.205.205.904.765.1.0.270.510.15.7.272.205.698.792.0.0.270.510.15.7.280.205.758.787.0.0.270.510.15.7.272.205.818.792.0.0.270",
            "11.142.116.1075.1330.777.811.1.0.-30.316.142.127.825.825.764.764.1.1.-1.138.142.127.450.450.849.874.1.1.-1.138.142.127.450.450.679.874.1.0.-1.311.142.127.251.303.552.787.1.1.-203.306.142.127.229.607.945.787.1.1.341.300.142.127.514.671.765.805.1.1.-181.415.142.127.217.220.765.893.1.1.-1",
            "11.145.145.2518.1881.764.764.1.0.0.504.40.40.220.475.764.904.1.0.0.504.40.40.220.475.764.624.1.1.180.504.40.40.220.475.904.764.1.1.90.504.40.40.220.475.624.764.1.0.270.504.145.145.300.135.1009.764.0.1.90.504.145.145.300.135.519.764.0.1.-90.504.145.145.300.135.764.518.0.1.-180.504.145.145.300.135.764.1009.0.1.0",
            "35.116.116.1470.1158.767.770.1.0.-1.206.127.116.-104.188.764.671.1.0.359.206.127.116.104.188.764.671.1.0.359.139.116.127.-215.299.813.650.0.0.0.139.116.127.215.299.716.650.0.0.0.315.116.127.166.128.764.647.1.0.180.427.116.116.547.-366.764.773.1.0.359.503.127.116.13.11.694.676.1.0.359.503.127.116.13.11.834.676.1.0.359",
            "11.149.116.1836.4896.772.942.1.1.90.518.31.116.40.50.936.658.0.0.90.518.31.116.40.50.980.705.0.0.90.518.31.116.40.40.711.554.0.0.90.518.31.116.40.40.816.554.0.0.90.518.31.116.40.40.764.523.0.0.90.518.31.116.40.40.592.658.0.0.90.518.31.116.40.40.548.704.0.0.90.500.40.116.671.796.764.754.0.0.180.212.40.116.400.400.764.869.0.0.0.340.40.116.117.117.764.628.0.0.0",
            "12.127.127.1625.1000.764.764.1.0.0.510.155.155.400.200.764.764.1.0.0.510.155.155.400.200.764.764.1.0.90.510.155.155.150.200.954.764.1.0.90.510.155.155.150.200.574.764.1.0.90.510.155.155.150.200.764.954.1.0.0.510.155.155.150.200.764.574.1.0.0.419.155.155.70.70.854.674.1.1.0.419.155.155.70.70.674.854.1.0.0.419.155.155.70.70.854.854.1.1.0.419.155.155.70.70.674.674.1.0.0.510.155.155.150.200.764.574.1.0.0.510.155.155.150.200.764.954.1.0.0",
            "1.128.137.1859.1853.766.762.1.0.321.304.116.116.293.293.764.574.1.0.0.304.116.116.293.293.764.953.1.1.180.503.116.116.293.293.764.764.1.0.0.401.137.116.352.352.764.764.1.1.0.344.127.116.194.194.811.764.1.1.0.344.127.116.193.193.716.764.1.0.0.201.116.111.94.132.764.764.1.1.-1",
            "5.143.33.1796.2002.768.788.1.1.210.204.35.116.605.605.771.801.1.1.0",
            "1.127.149.1788.1788.764.764.1.0.0.118.116.128.550.550.754.764.1.1.0.306.128.149.550.550.1238.765.0.1.0.306.149.128.550.550.289.764.1.0.0",
            "1.145.128.1828.1561.764.921.1.0.90.302.116.116.360.420.636.764.0.0.214.302.116.116.360.420.892.764.0.0.146.302.149.149.350.420.764.729.0.0.180",
            "2.3.31.3918.1836.550.748.1.0.-30.516.141.116.223.223.602.532.1.1.0.516.141.116.228.228.925.536.1.1.0.516.141.116.219.219.765.997.1.1.0",
            "11.41.124.1307.1778.864.841.0.0.270.505.149.127.1670.527.764.764.0.0.0.503.149.127.1200.1200.762.756.0.0.0.155.41.149.578.578.1041.764.1.0.0.158.41.149.600.600.480.736.1.1.19.158.41.149.247.247.676.937.1.1.43.158.41.149.247.247.624.520.1.1.-3",
            "30.116.116.1407.1104.771.765.1.0.0.207.110.110.-147.-148.827.785.1.0.-141.207.110.110.159.-177.686.802.1.0.-220.154.110.110.110.-150.734.810.1.0.166.154.110.110.-125.-88.802.800.1.0.177.428.110.110.-368.342.760.920.1.0.-1.202.110.110.-237.201.705.942.1.0.-42.202.110.110.-237.201.817.942.1.1.41.212.110.110.453.368.762.643.1.0.0.214.110.110.533.190.764.566.1.0.0.215.110.110.498.216.763.575.1.0.180",
            "11.100.100.2000.2000.764.764.1.0.0.337.132.132.597.644.764.764.0.0.0",
            "30.116.126.1616.1594.766.728.1.0.0.419.142.28.125.115.1404.1254.0.1.0.505.116.28.930.1074.345.277.0.1.0.505.116.28.915.1057.1199.1253.0.1.0.510.28.116.3830.500.764.764.1.1.0.510.28.116.3830.500.774.762.1.1.90.505.28.28.145.77.770.761.0.1.0.510.116.142.1657.345.770.762.0.1.0.510.116.142.1657.345.773.762.0.1.90.120.127.116.711.690.787.738.1.1.0.159.83.116.104.101.670.574.1.1.-21",
            "30.40.137.2906.2895.787.755.0.0.341.120.83.116.293.293.764.764.0.0.0",
            "36.84.138.1836.1836.768.788.1.0.0.457.149.83.663.663.764.788.1.1.0",
            "5.149.116.1811.1811.707.762.1.1.90.428.142.140.680.411.764.764.1.1.0.457.142.140.939.801.764.786.1.1.0.159.142.140.472.456.764.601.1.1.0.510.142.140.1946.1501.1369.909.1.1.270.510.142.140.1946.1501.166.764.1.1.270.322.142.140.620.3170.165.925.1.1.0.322.142.140.620.3170.1370.899.1.1.0",
            "2.0.35.3000.2700.0.0.1.0.0.424.131.149.240.240.764.994.1.0.0.424.131.149.240.240.884.774.1.0.0.424.131.149.240.240.644.774.1.0.0.424.131.149.240.240.956.544.1.0.0.424.131.149.240.240.764.544.1.0.0.424.131.149.240.240.572.544.1.0.0",
            "11.119.121.2500.2500.1298.837.1.0.0.141.121.116.508.460.764.577.1.0.0.141.121.116.508.460.764.793.1.0.0.141.121.116.508.460.764.1009.1.0.0.340.121.116.146.122.706.716.1.0.-12.340.121.116.146.122.706.930.1.0.-12.340.121.116.146.122.706.506.1.0.-12",
            "24.142.111.2168.1325.762.873.1.1.0.133.116.22.240.240.758.764.1.0.0.133.116.22.240.240.758.764.1.0.0.133.116.22.240.240.758.764.1.0.0",
            "30.40.137.2906.2895.787.755.0.0.341.120.83.116.293.293.764.764.0.0.0",
            "11.58.149.1476.1263.764.764.1.0.0.410.148.58.129.158.763.998.1.0.180.456.148.58.169.127.671.791.1.0.-200.456.148.58.169.127.857.791.1.1.200.139.148.58.441.297.883.842.1.0.220.139.148.58.441.297.645.842.1.1.140.439.148.58.191.293.761.802.1.0.0.434.148.58.356.509.582.668.1.0.0.434.148.58.356.509.947.668.1.1.0.433.148.58.220.220.645.666.1.1.240.433.148.58.220.220.883.666.1.0.120",
            "35.2.116.1425.1134.769.768.1.0.0.510.35.35.1617.936.764.843.1.0.0.510.35.35.1820.934.764.710.1.0.0.510.35.35.1820.115.764.773.1.0.0.219.148.35.229.211.764.764.1.0.0",
            "11.116.116.1836.4896.772.942.1.1.90.503.31.116.743.743.764.764.0.0.-46.503.146.116.662.662.764.764.0.0.-46.427.127.116.467.145.764.938.0.0.0.427.127.116.460.399.764.835.0.0.0.428.127.116.400.455.764.706.0.0.0.503.146.116.341.300.764.849.0.0.0.503.146.116.305.292.764.654.0.0.0.515.128.116.116.116.764.881.0.0.-46.301.128.116.403.460.764.764.0.0.0",
            "11.128.128.5000.5000.768.788.1.0.0.510.116.116.730.865.764.626.0.1.0.510.116.116.1077.866.764.764.0.1.90.510.148.116.313.885.764.431.0.1.90",
            "11.148.149.3840.2160.764.764.1.0.0.505.149.128.650.3000.764.758.1.0.60.514.40.7.209.157.706.580.0.0.23.514.40.7.158.118.815.586.0.0.-20.323.15.15.436.436.758.761.1.0.0.505.0.7.221.333.758.766.0.0.0.503.40.7.65.106.626.614.0.0.-8.330.15.15.205.205.904.765.1.0.270.510.15.7.272.205.698.792.0.0.270.510.15.7.280.205.758.787.0.0.270.510.15.7.272.205.818.792.0.0.270.510.15.7.272.205.2136.528.0.0.270",
            "18.94.4.2083.2019.744.805.1.0.60.436.86.116.1141.1141.767.754.1.0.0",
            "11.149.149.1960.1636.768.788.1.0.0.216.44.44.211.-376.711.649.0.0.-263.216.44.44.211.-376.619.719.0.0.-224.216.44.44.211.-376.821.643.0.1.262.216.44.44.211.-376.913.713.0.1.223.216.44.44.211.-376.711.869.0.1.82.216.44.44.211.-376.619.799.0.1.43.216.44.44.211.-376.821.875.0.0.-83.216.44.44.211.-376.913.805.0.0.-44.509.47.47.322.-188.764.770.1.0.0.309.47.47.183.-111.918.638.1.1.278.309.47.47.186.-94.864.730.1.1.95.309.149.149.212.-128.928.576.1.1.278.309.149.149.212.-128.952.596.1.1.310.309.47.47.183.-111.610.638.1.0.81.309.47.47.186.-94.664.730.1.0.-96.309.149.149.212.-128.600.576.1.0.-279.309.149.149.212.-128.576.596.1.0.49.309.47.47.131.-79.684.615.1.0.55.309.47.47.133.-67.690.690.1.0.-122.309.149.149.151.-91.697.572.1.0.-305.309.149.149.151.-91.676.577.1.0.23.309.47.47.131.-79.844.615.1.1.304.309.47.47.133.-67.838.690.1.1.121.309.149.149.151.-91.831.572.1.1.304.309.149.149.151.-91.853.577.1.1.336.309.47.47.131.-79.942.689.1.1.247.309.47.47.133.-67.876.726.1.1.64.309.149.149.151.-91.971.654.1.1.247.309.149.149.151.-91.978.675.1.1.280.309.47.47.131.-79.586.689.1.0.112.309.47.47.133.-67.652.726.1.0.295.309.149.149.151.-91.557.654.1.0.112.309.149.149.151.-91.550.675.1.0.79.309.47.47.183.-111.996.733.1.1.234.309.47.47.186.-94.894.763.1.1.51.309.149.149.212.-128.1046.696.1.1.234.309.149.149.212.-128.1049.726.1.1.267.309.47.47.183.-111.540.733.1.0.125.309.47.47.186.-94.642.763.1.0.308.309.149.149.212.-128.490.696.1.0.125.309.149.149.212.-128.487.726.1.0.92.309.47.47.131.-79.557.792.1.0.155.309.47.47.133.-67.630.773.1.0.-22.309.149.149.151.-91.512.787.1.0.-205.309.149.149.151.-91.521.807.1.0.123.309.47.47.131.-79.972.792.1.1.204.309.47.47.133.-67.899.773.1.1.21.309.149.149.151.-91.1017.786.1.1.204.309.149.149.151.-91.1008.807.1.1.236.309.47.47.183.-111.564.858.1.0.178.309.47.47.186.-94.649.794.1.0.1.309.149.149.212.-128.503.875.1.0.177.309.149.149.212.-128.526.896.1.0.145.309.47.47.183.-111.962.858.1.1.181.309.47.47.186.-94.877.794.1.1.358.309.149.149.212.-128.1023.874.1.1.182.309.149.149.212.-128.1000.896.1.1.214.309.47.47.131.-79.634.881.1.0.193.309.47.47.133.-67.681.821.1.0.16.309.149.149.151.-91.596.904.1.0.-167.309.149.149.151.-91.616.915.1.0.161.309.47.47.131.-79.896.881.1.1.166.309.47.47.133.-67.849.821.1.1.343.309.149.149.151.-91.934.904.1.1.166.309.149.149.151.-91.915.915.1.1.198.309.47.47.183.-111.709.921.1.1.127.309.47.47.186.-94.710.815.1.1.304.309.149.149.212.-128.730.980.1.1.127.309.149.149.212.-128.700.974.1.1.160.309.47.47.183.-111.819.921.1.0.232.309.47.47.186.-94.818.815.1.0.55.309.149.149.212.-128.797.980.1.0.232.309.149.149.212.-128.828.974.1.0.199.301.47.47.679.-626.768.794.0.0.0.110.47.47.229.-242.764.612.1.0.0.110.116.116.213.-192.764.612.1.0.-1.301.116.116.494.-599.767.794.0.0.0.510.47.47.402.-25.764.839.1.0.90.402.47.47.40.-54.764.490.0.0.-90.401.47.47.30.-24.764.615.1.0.-89.314.116.116.129.-109.676.779.1.0.-45.314.116.116.129.-109.724.805.1.0.-15.314.116.116.130.-109.850.776.1.1.47.314.116.116.130.-109.803.805.1.1.17.314.116.116.150.-109.813.735.1.1.147.314.116.116.150.-109.713.735.1.0.212.427.116.116.231.-116.764.745.1.0.0.506.17.17.389.-86.767.768.1.0.-1.503.116.116.120.-96.763.764.1.0.0.503.47.47.71.-65.763.751.1.0.0.403.116.116.291.-151.764.765.1.0.0.309.116.116.63.-49.904.759.1.0.-206.309.116.116.63.-49.622.759.1.1.205.320.17.17.47.-619.141.592.0.0.0.320.17.17.47.-619.141.1002.0.1.180.320.17.17.47.-619.1393.583.0.0.0.320.17.17.47.-619.1393.993.0.1.180.320.17.17.47.-619.420.308.0.0.89.320.17.17.47.-619.1113.306.0.1.270.322.17.17.103.-116.766.308.1.1.270.322.17.17.103.-116.766.308.1.0.89.320.17.17.47.-619.1113.1281.0.1.270.320.17.17.47.-619.420.1279.0.0.89.322.17.17.103.-116.767.1280.1.0.89.322.17.17.103.-116.767.1280.1.1.270.324.38.38.13.-598.1393.1138.0.1.179.324.38.38.13.-598.1393.851.0.0.-180.324.38.38.13.-598.1393.445.0.0.0.324.38.38.13.-598.1393.656.0.0.0.324.38.38.13.-598.141.1142.0.1.179.324.38.38.13.-598.141.855.0.0.-180.324.38.38.13.-598.141.449.0.0.0.324.38.38.13.-598.141.659.0.0.0.324.38.38.11.-527.267.307.0.1.89.324.38.38.11.-527.520.307.0.0.-270.324.38.38.11.-527.878.307.0.0.-90.324.38.38.11.-527.692.307.0.0.-90.324.38.38.11.-527.642.305.0.1.89.324.38.38.11.-527.895.305.0.0.-270.324.38.38.11.-527.1253.306.0.0.-90.324.38.38.11.-527.1067.305.0.0.-90.324.38.38.11.-527.274.1279.0.1.89.324.38.38.11.-527.527.1280.0.0.-270.324.38.38.11.-527.885.1280.0.0.-90.324.38.38.11.-527.700.1280.0.0.-90.324.38.38.11.-527.649.1277.0.1.89.324.38.38.11.-527.902.1278.0.0.-270.324.38.38.11.-527.1260.1278.0.0.-90.324.38.38.11.-527.1075.1278.0.0.-90.323.47.47.22.-483.176.571.0.0.-180.323.47.47.22.-483.176.1015.0.0.0.323.47.47.22.-483.1357.572.0.0.-180.323.47.47.22.-483.1357.1015.0.0.0.323.47.47.22.-483.670.1244.0.0.-90.323.47.47.22.-483.1114.1246.0.0.90.323.47.47.22.-483.851.1244.0.1.89.323.47.47.22.-483.407.1246.0.1.269.323.47.47.22.-483.670.343.0.1.269.323.47.47.22.-483.1114.341.0.1.89.323.47.47.22.-483.851.343.0.0.90.323.47.47.22.-483.407.341.0.0.-90",
            "30.131.55.1536.1536.806.767.1.0.0.520.90.128.720.720.764.764.1.1.0.520.120.89.642.642.764.764.1.1.0.520.2.89.482.482.764.764.1.1.0.220.55.55.428.428.748.744.1.1.48.220.83.55.428.428.761.734.1.1.13.503.35.35.150.150.764.764.1.1.150.222.132.55.220.220.764.764.1.1.42",
            "24.51.111.2168.1325.762.873.1.1.0.133.116.22.240.240.758.764.1.0.0.133.116.22.240.240.758.764.1.0.0",
            "24.51.111.2168.1325.762.873.1.1.0.133.116.22.240.240.758.764.1.0.0.133.116.22.240.240.758.764.1.0.0",
            "11.116.19.1821.1821.760.755.1.0.0.406.116.119.634.634.764.764.1.1.0.316.116.119.414.414.764.779.1.1.0.111.116.119.234.234.758.787.1.0.0",
            "3.12.142.1602.1099.773.764.1.0.0.142.84.116.1034.949.807.710.0.0.0.505.12.116.154.188.538.586.0.0.48.309.84.116.196.210.576.632.0.0.60.213.84.116.204.920.947.644.0.1.-66.119.84.116.376.359.576.672.0.1.24.506.84.116.236.268.686.775.0.1.90.213.84.116.204.886.801.596.0.0.311.510.84.116.223.526.554.696.0.1.241.213.84.116.238.524.746.817.0.0.-91.510.84.116.223.526.987.752.0.1.241",
            "1.2.40.787.787.764.77.1.0.0.316.83.83.691.-693.760.771.1.0.-181.05.1",
            "3.100.116.2303.2303.764.614.0.1.315.339.82.59.214.214.391.652.0.0.0.203.116.116.1274.1274.764.747.1.0.0.503.121.59.500.500.1128.641.0.0.0.503.0.59.500.500.1105.622.0.0.0.344.132.59.358.358.1115.611.0.0.170.500.132.59.449.449.1109.622.0.0.0.503.121.59.500.500.415.631.0.0.0.503.0.59.500.500.391.611.0.0.0.344.132.59.358.358.391.611.0.0.0.500.132.59.449.449.391.611.0.0.0",
            "24.51.111.2168.1325.762.873.1.1.0.133.116.22.240.240.758.764.1.0.0.133.116.22.240.240.758.764.1.0.0",
            "27.35.83.2210.2283.766.700.1.0.-181.111.35.116.468.468.777.706.1.1.0",
            "11.41.124.1307.1778.864.841.0.0.270.505.149.127.1670.527.764.764.0.0.0.503.149.127.1200.1200.762.756.0.0.0.155.41.149.578.578.1041.764.1.0.0.158.41.149.600.600.480.736.1.1.19.158.41.149.247.247.676.937.1.1.43.158.41.149.247.247.624.520.1.1.-3",
            "26.111.111.5023.4884.669.737.0.0.-1.304.116.116.293.293.764.574.1.0.0.304.116.116.293.293.764.954.1.1.180.503.116.116.288.288.764.764.1.0.0.423.137.116.352.352.764.764.1.1.0.421.110.116.278.240.764.776.1.0.-90.503.19.116.129.172.764.745.0.1.-1.427.40.116.104.125.764.778.1.0.0.503.116.116.123.136.764.732.1.0.0.347.19.116.159.148.764.728.1.0.0",
            "1.145.145.1307.1778.864.841.0.0.270.506.41.149.1482.479.450.983.1.0.90.506.41.149.1526.479.1067.967.1.0.90.506.41.149.1304.288.744.823.0.0.-1.506.39.149.267.84.764.909.0.0.-1.531.149.149.163.61.696.903.0.0.91.531.149.149.163.61.775.902.0.0.91.531.149.149.163.61.819.900.0.0.91.531.149.149.163.61.730.903.0.0.92.506.41.149.1670.319.764.668.1.0.0.506.41.149.1670.293.760.676.1.0.0",
            "7.116.116.1836.1836.768.788.1.0.-30.123.35.116.1147.754.764.764.1.1.-20.439.35.116.272.179.736.596.1.1.98.439.35.116.272.179.762.744.1.1.98.439.35.116.272.179.644.791.1.1.105.439.35.116.272.179.598.640.1.1.107.439.35.116.272.179.468.716.1.1.118.439.35.116.272.179.524.849.1.1.118.439.35.116.139.179.867.648.1.1.82.427.83.116.70.78.1040.682.1.1.216",
            "22.116.8.1836.1836.768.788.1.0.-30.423.126.116.575.575.764.764.1.0.0.524.92.116.114.114.886.845.1.0.-53.125.0.8.-200.200.924.813.1.1.0.128.0.8.-200.200.598.820.1.1.0.130.0.8.200.200.742.837.1.1.0.309.144.116.156.145.693.732.1.0.-8.315.144.116.175.162.835.752.1.0.-40.340.143.116.150.150.765.738.1.1.0.529.84.116.175.175.721.605.1.0.0.529.84.116.187.187.829.609.1.0.0",
            "1.148.98.1836.1198.768.788.1.0.0.419.143.143.607.607.764.762.0.1.0",
            "1.35.149.903.850.758.740.1.0.-1.503.86.116.240.240.2509.2014.1.0.0.133.88.116.240.240.764.764.1.0.0",
            "19.35.19.1836.1836.768.788.1.0.-30.505.71.116.424.847.586.761.1.0.0.505.70.70.416.843.955.762.1.0.0.341.76.116.488.488.752.754.1.1.0.158.132.116.373.419.775.748.1.0.-30",
            "35.2.116.1425.1134.769.768.1.0.0.510.35.35.1617.936.764.843.1.0.0.510.35.35.1820.934.764.710.1.0.0.510.35.35.1820.115.764.773.1.0.0.219.148.35.229.211.764.764.1.0.0",
            "11.8.19.890.890.764.774.1.0.0.423.132.8.897.897.764.764.1.1.0.106.132.8.600.600.764.764.1.1.0.438.132.8.434.469.763.932.1.1.0",
            "1.35.149.903.850.758.740.1.0.-1.503.86.116.240.240.2509.2014.1.0.0.133.88.116.240.240.764.764.1.0.0",
            "1.14.14.608.758.758.767.1.0.-1.503.86.116.240.240.2509.2014.1.0.0.133.88.116.240.240.764.764.1.0.0",
            "27.35.83.2210.2283.766.700.1.0.-181.111.35.116.468.468.777.706.1.1.0",
            "11.148.148.1836.1836.764.764.1.0.-30.419.148.155.600.600.762.762.1.0.0.424.148.155.184.182.649.649.1.0.45.424.148.155.184.182.649.879.1.0.140.424.148.155.184.182.879.879.1.0.220.424.148.155.184.182.879.649.1.0.320.522.148.155.360.360.764.764.1.0.45",
            "9.130.116.1431.1431.764.764.1.0.0.505.116.116.1454.1061.764.764.1.0.0.316.4.116.886.728.764.764.1.0.0.344.116.4.706.580.764.783.1.0.0",
            "27.25.138.2152.2152.764.764.0.0.0.462.116.116.685.794.764.764.1.0.180.535.111.116.272.439.881.616.1.0.316.535.111.116.272.439.648.612.1.1.43.133.2.116.886.892.764.684.1.1.0.503.144.0.188.96.763.857.1.0.0.133.111.116.846.871.764.683.0.1.0.442.132.116.170.221.766.897.0.1.0.442.12.116.170.221.762.897.0.0.0.434.0.116.119.363.938.622.0.0.-50.434.0.116.119.363.590.622.0.1.49",
            "NaN.116.116.1450.1683.781.773.1.0.0.510.48.48.560.165.775.842.1.0.-90.500.116.116.-135.119.823.729.1.0.30.500.116.116.-61.63.879.748.1.0.30.500.116.116.-61.63.811.787.1.0.30.416.45.116.99.129.840.758.1.0.210.503.45.116.130.117.822.731.1.0.30.503.45.45.57.53.878.747.1.0.30.503.45.45.57.53.812.786.1.0.30.505.45.45.46.35.858.790.1.0.30.509.116.116.42.31.863.743.1.1.30.503.116.116.29.22.856.743.1.1.30.503.116.116.30.21.871.746.1.1.30.509.116.116.42.31.815.771.1.0.30.503.116.116.29.22.819.764.1.0.30.503.116.116.30.21.812.779.1.0.30.514.116.116.24.28.852.779.1.0.210.503.48.48.79.93.775.566.1.0.-90.504.48.48.89.205.775.489.1.0.0.510.48.48.69.45.775.627.1.0.0.510.116.116.37.53.777.644.1.0.0.510.116.116.23.19.781.775.1.0.-82.510.116.116.23.19.882.715.1.1.141.427.116.116.-15.8.837.795.1.1.169.427.116.116.-15.8.873.775.1.0.251.500.116.116.-135.119.866.864.1.0.27.500.116.116.-61.63.921.885.1.0.27.500.116.116.-61.63.852.922.1.0.27.416.45.116.99.129.882.894.1.0.207.503.45.116.130.117.866.866.1.0.27.503.45.45.57.53.921.885.1.0.27.503.45.45.57.53.853.921.1.0.27.505.45.45.46.35.899.926.1.0.27.509.116.116.42.31.906.880.1.1.27.503.116.116.29.22.899.879.1.1.27.503.116.116.30.21.914.883.1.1.27.509.116.116.42.31.857.906.1.0.27.503.116.116.29.22.861.899.1.0.27.503.116.116.30.21.854.913.1.0.27.514.116.116.24.28.893.915.1.0.207.510.116.116.23.19.823.908.1.0.-85.510.116.116.23.19.927.853.1.1.138.427.116.116.-15.8.877.931.1.1.166.427.116.116.-15.8.915.912.1.0.248.500.116.116.-135.119.848.987.1.0.12.500.116.116.-61.63.896.1022.1.0.12.500.116.116.-61.63.819.1039.1.0.12.416.45.116.99.129.856.1020.1.0.192.503.45.116.130.117.847.989.1.0.12.503.45.45.57.53.896.1022.1.0.12.503.45.45.57.53.821.1038.1.0.12.505.45.45.46.35.864.1056.1.0.12.509.116.116.42.31.882.1013.1.1.12.503.116.116.29.22.876.1010.1.1.12.503.116.116.30.21.890.1018.1.1.12.509.116.116.42.31.828.1025.1.0.12.503.116.116.29.22.834.1019.1.0.12.503.116.116.30.21.823.1031.1.0.12.514.116.116.24.28.861.1043.1.0.192.510.116.116.377.28.805.833.1.1.97.510.116.116.23.19.795.1018.1.0.-100.510.116.116.23.19.909.992.1.1.123.427.116.116.-15.8.842.1054.1.1.151.427.116.116.-15.8.883.1046.1.0.233.500.116.116.-139.123.778.851.1.0.13.500.116.116.-63.65.828.886.1.0.13.500.116.116.-63.65.749.904.1.0.13.416.45.116.103.133.786.884.1.0.193.503.45.116.134.121.777.853.1.0.13.503.45.45.59.55.827.886.1.0.13.503.45.45.59.55.750.904.1.0.13.505.45.45.47.36.795.921.1.0.13.509.116.116.44.32.814.877.1.1.13.503.116.116.30.22.807.874.1.1.13.503.116.116.31.22.821.882.1.1.13.509.116.116.44.32.758.890.1.0.13.503.116.116.30.22.764.884.1.0.13.503.116.116.31.22.753.897.1.0.13.514.116.116.25.29.792.908.1.0.193.510.116.116.24.19.724.884.1.0.-99.510.116.116.24.19.841.855.1.1.124.427.116.116.-15.8.772.920.1.1.152.427.116.116.-15.8.814.911.1.0.234.500.116.116.-139.123.637.879.1.0.-21.500.116.116.-63.65.658.937.1.0.-21.500.116.116.-63.65.583.907.1.0.-21.416.45.116.103.133.625.912.1.0.158.503.45.116.134.121.635.881.1.0.-22.503.45.45.59.55.658.936.1.0.-22.503.45.45.59.55.584.907.1.0.-22.505.45.45.47.36.612.947.1.0.-22.509.116.116.44.32.652.921.1.1.-22.503.116.116.30.22.648.915.1.1.-22.503.116.116.31.22.655.929.1.1.-22.509.116.116.44.32.598.901.1.0.-22.503.116.116.30.22.607.899.1.0.-22.503.116.116.31.22.591.903.1.0.-22.514.116.116.25.29.616.935.1.0.158.510.116.116.24.19.574.876.1.0.-133.510.116.116.24.19.687.919.1.1.90.427.116.116.-15.8.593.934.1.1.117.510.116.116.309.23.709.783.1.1.66.427.116.116.-15.8.633.950.1.0.199.500.116.116.-147.131.716.758.1.0.-17.510.116.116.235.24.777.763.1.1.90.500.116.116.-67.69.744.817.1.0.-17.500.116.116.-67.69.661.792.1.0.-17.416.45.116.109.142.706.793.1.0.163.503.45.116.142.128.714.760.1.0.-17.503.45.45.62.58.743.816.1.0.-17.503.45.45.62.58.663.792.1.0.-17.505.121.121.1.-176.716.839.1.0.-144.509.116.116.46.34.735.801.1.1.-17.503.116.116.32.24.730.795.1.1.-17.503.116.116.33.23.740.809.1.1.-17.509.116.116.46.34.677.784.1.0.-17.503.116.116.32.24.686.781.1.0.-17.503.116.116.33.23.669.787.1.0.-17.514.116.116.27.30.699.818.1.0.163.510.116.116.25.21.649.760.1.0.-128.510.116.116.25.21.772.795.1.1.94.427.116.116.-16.9.674.819.1.1.122.427.116.116.-16.9.718.833.1.0.204.500.116.116.-122.108.724.918.1.0.8.500.116.116.-55.57.765.952.1.0.8.500.116.116.-55.57.694.963.1.0.8.416.45.116.90.117.729.948.1.0.188.503.45.116.118.106.723.920.1.0.8.503.45.45.51.48.764.952.1.0.8.503.45.45.51.48.696.962.1.0.8.505.45.45.41.32.733.981.1.0.8.509.116.116.38.28.753.943.1.1.8.503.116.116.27.20.747.940.1.1.8.503.116.116.27.19.759.948.1.1.8.509.116.116.38.28.703.951.1.0.8.503.116.116.27.20.709.946.1.0.8.503.116.116.27.19.699.956.1.0.8.514.116.116.22.25.732.969.1.0.188.510.116.116.21.17.674.943.1.0.-103.510.116.116.21.17.779.926.1.1.119.427.116.116.-14.7.714.978.1.1.147.427.116.116.-14.7.751.973.1.0.229.510.116.116.180.26.715.717.1.0.236.510.116.116.117.26.829.691.1.1.129.510.116.116.274.27.828.771.1.1.108.510.116.116.309.27.742.794.1.1.78.510.121.121.34.24.699.818.1.0.253.510.121.121.34.24.610.954.1.0.253.510.121.121.26.24.866.1061.1.1.286",
            "11.116.0.1000.1000.764.764.0.0.0.213.142.116.300.300.554.668.0.0.50.213.142.116.300.300.857.574.0.0.-39.213.2.116.300.300.670.574.0.1.-321.213.2.116.300.300.555.860.0.1.128.213.142.116.300.300.973.860.0.0.-129.213.2.116.300.300.973.668.0.1.-51.213.2.116.300.300.858.953.0.1.-141.213.142.116.300.300.670.954.0.1.-220.503.116.0.641.442.764.764.0.0.0.341.2.116.300.300.786.751.0.0.-1",
        };

        string targetBanner = "11.145.145.2518.1881.764.764.1.0.0.504.40.40.220.475.764.904.1.0.0.504.40.40.220.475.764.624.1.1.180.504.40.40.220.475.904.764.1.1.90.504.40.40.220.475.624.764.1.0.270.504.145.145.300.135.1009.764.0.1.90.504.145.145.300.135.519.764.0.1.-90.504.145.145.300.135.764.518.0.1.-180.504.145.145.300.135.764.1009.0.1.0";

        Mission.Current.AllowAiTicking = false;
        foreach (Team team in Mission.Teams)
        {
            if (Mission.AttackerTeam != team && Mission.DefenderTeam != team)
            {
                continue;
            }

            BasicCultureObject teamCulture = team == Mission.AttackerTeam ? cultureTeam1 : cultureTeam2;
            int numberOfBots = Mission.AttackerTeam == team ? botsTeam1 : botsTeam2;
            int botsAlive = team.ActiveAgents.Count(a => a.IsAIControlled && a.IsHuman);

            for (int i = 0 + botsAlive; i < numberOfBots; i += 1)
            {
                MultiplayerClassDivisions.MPHeroClass botClass = MultiplayerClassDivisions
                    .GetMPHeroClasses()
                    .GetRandomElementWithPredicate<MultiplayerClassDivisions.MPHeroClass>(x => x.Culture == teamCulture);
                BasicCharacterObject character = botClass.HeroCharacter;

                bool hasMount = character.Equipment[EquipmentIndex.Horse].Item != null;
                MatrixFrame spawnFrame = SpawnComponent.GetSpawnFrame(team, hasMount, true);
                Vec2 initialDirection = spawnFrame.rotation.f.AsVec2.Normalized();

                AgentBuildData agentBuildData = new AgentBuildData(character)
                    .Equipment(character.Equipment)
                    .TroopOrigin(new BasicBattleAgentOrigin(character))
                    .EquipmentSeed(MissionLobbyComponent.GetRandomFaceSeedForCharacter(character))
                    .Team(team)
                    .VisualsIndex(0)
                    .InitialPosition(in spawnFrame.origin)
                    .InitialDirection(in initialDirection)
                    .IsFemale(character.IsFemale)
                    .ClothingColor1(team.Side == BattleSideEnum.Attacker ? teamCulture.Color : teamCulture.ClothAlternativeColor)
                    .ClothingColor2(team.Side == BattleSideEnum.Attacker ? teamCulture.Color2 : teamCulture.ClothAlternativeColor2)
                    .NoHorses(true); // Bots with horses are just running around most of the time.

                Random random = new();
                if (TryParseBanner(targetBanner, out var botBanner))
                {
                    agentBuildData.Banner(botBanner);
                }
                else
                {
                    //Console.WriteLine("Failed parsing banner");
                }
                if (_bannerProg++ > 10)
                {

                    _bannerProg = 0;
                    _bannerCounter = _bannerCounter == bannerList.Length ? 0 : _bannerCounter + 1;
                    Console.WriteLine("NEW BANNER ID: " + _bannerCounter);
                    Console.WriteLine("NEW BANNER ID: " + _bannerCounter);
                    Console.WriteLine("NEW BANNER ID: " + _bannerCounter);
                    Console.WriteLine("NEW BANNER ID: " + _bannerCounter);
                    Console.WriteLine("NEW BANNER ID: " + _bannerCounter);
                }


                var bodyProperties = BodyProperties.GetRandomBodyProperties(
                    character.Race,
                    character.IsFemale,
                    character.GetBodyPropertiesMin(),
                    character.GetBodyPropertiesMax(),
                    (int)agentBuildData.AgentOverridenSpawnEquipment.HairCoverType,
                    agentBuildData.AgentEquipmentSeed,
                    character.HairTags,
                    character.BeardTags,
                    character.TattooTags);
                agentBuildData.BodyProperties(bodyProperties);

                Agent agent = Mission.SpawnAgent(agentBuildData);
                agent.SetWatchState(Agent.WatchState.Alarmed);
                agent.WieldInitialWeapons();
            }
        }
    }

    private void SpawnPeerAgents()
    {
        BasicCultureObject cultureTeam1 = MBObjectManager.Instance.GetObject<BasicCultureObject>(MultiplayerOptions.OptionType.CultureTeam1.GetStrValue());
        BasicCultureObject cultureTeam2 = MBObjectManager.Instance.GetObject<BasicCultureObject>(MultiplayerOptions.OptionType.CultureTeam2.GetStrValue());

        foreach (NetworkCommunicator networkPeer in GameNetwork.NetworkPeers)
        {
            var missionPeer = networkPeer.GetComponent<MissionPeer>();
            var crpgRepresentative = networkPeer.GetComponent<CrpgRepresentative>();
            if (!networkPeer.IsSynchronized
                || missionPeer.ControlledAgent != null
                || missionPeer.HasSpawnedAgentVisuals
                || missionPeer.Team == null
                || missionPeer.Team == Mission.SpectatorTeam
                || crpgRepresentative?.User == null
                || crpgRepresentative.SpawnTeamThisRound != null)
            {
                continue;
            }

            var characterEquipment = CreateCharacterEquipment(crpgRepresentative.User.Character.EquippedItems);
            if (!DoesEquipmentContainWeapon(characterEquipment)) // Disallow spawning without weapons.
            {
                continue;
            }

            bool hasMount = characterEquipment[EquipmentIndex.Horse].Item != null;
            // Disallow spawning cavalry before the cav spawn delay ended.
            if (hasMount && (!_cavalrySpawnDelay?.Check() ?? false))
            {
                if (_notifiedPlayersAboutDelayedSpawn.Add(networkPeer.VirtualPlayer.Id))
                {
                    GameNetwork.BeginModuleEventAsServer(networkPeer);
                    GameNetwork.WriteMessage(new CrpgNotification
                    {
                        Type = CrpgNotification.NotificationType.Notification,
                        Message = $"Cavalry will spawn in {CavalrySpawnDelay} seconds!",
                        IsMessageTextId = false,
                        SoundEvent = string.Empty,
                    });
                    GameNetwork.EndModuleEventAsServer();
                }

                continue;
            }

            BasicCultureObject teamCulture = missionPeer.Team == Mission.AttackerTeam ? cultureTeam1 : cultureTeam2;
            var peerClass = MultiplayerClassDivisions.GetMPHeroClasses().Skip(5).First();
            // var character = CreateCharacter(crpgRepresentative.User.Character, _constants);
            var characterSkills = CreateCharacterSkills(crpgRepresentative.User.Character.Characteristics);
            var character = peerClass.HeroCharacter;

            // Used to reset the selected perks for the current troop. Otherwise the player might have addional stats.
            missionPeer.SelectedTroopIndex = -1;
            MatrixFrame spawnFrame = missionPeer.GetAmountOfAgentVisualsForPeer() > 0
                ? missionPeer.GetAgentVisualForPeer(0).GetFrame()
                : SpawnComponent.GetSpawnFrame(missionPeer.Team, hasMount, true);
            Vec2 initialDirection = spawnFrame.rotation.f.AsVec2.Normalized();

            uint color1;
            uint color2;
            if (crpgRepresentative.Clan != null && TryParseBanner(missionPeer.Peer.BannerCode, out var banner))
            {
                color1 = crpgRepresentative.Clan.PrimaryColor;
                color2 = crpgRepresentative.Clan.SecondaryColor;
            }
            else
            {
                color1 = missionPeer.Team == Mission.AttackerTeam
                    ? teamCulture.Color
                    : teamCulture.ClothAlternativeColor;
                color2 = missionPeer.Team == Mission.AttackerTeam
                    ? teamCulture.Color2
                    : teamCulture.ClothAlternativeColor2;
                TryParseBanner(teamCulture.BannerKey, out banner);
            }

            AgentBuildData agentBuildData = new AgentBuildData(character)
                .MissionPeer(missionPeer)
                .Equipment(characterEquipment)
                .TroopOrigin(new CrpgBattleAgentOrigin(character, characterSkills))
                .Team(missionPeer.Team)
                .VisualsIndex(0)
                .IsFemale(missionPeer.Peer.IsFemale)
                .ClothingColor1(color1)
                .ClothingColor2(color2)
                .BodyProperties(GetBodyProperties(missionPeer, teamCulture))
                .InitialPosition(in spawnFrame.origin)
                .InitialDirection(in initialDirection);

            if (banner != null)
            {
                agentBuildData.Banner(banner);
            }

            Agent agent = Mission.SpawnAgent(agentBuildData);
            agent.WieldInitialWeapons();

            if (_roundController != null)
            {
                missionPeer.SpawnCountThisRound += 1;
                crpgRepresentative.SpawnTeamThisRound = missionPeer.Team;
            }
        }
    }

    private BasicCharacterObject CreateCharacter(CrpgCharacter crpgCharacter, CrpgConstants constants)
    {
        var skills = CreateCharacterSkills(crpgCharacter.Characteristics);
        return CrpgCharacterObject.New(new TextObject(crpgCharacter.Name), skills, constants);
    }

#pragma warning disable SA1202 // Suppress the static warning.
    internal static CharacterSkills CreateCharacterSkills(CrpgCharacterCharacteristics characteristics)
    {
        CharacterSkills skills = new();
        skills.SetPropertyValue(CrpgSkills.Strength, characteristics.Attributes.Strength);
        skills.SetPropertyValue(CrpgSkills.Agility, characteristics.Attributes.Agility);

        skills.SetPropertyValue(CrpgSkills.IronFlesh, characteristics.Skills.IronFlesh);
        skills.SetPropertyValue(CrpgSkills.PowerStrike, characteristics.Skills.PowerStrike);
        skills.SetPropertyValue(CrpgSkills.PowerDraw, characteristics.Skills.PowerDraw);
        skills.SetPropertyValue(CrpgSkills.PowerThrow, characteristics.Skills.PowerThrow);
        skills.SetPropertyValue(DefaultSkills.Athletics, characteristics.Skills.Athletics * 20 + 2 * characteristics.Attributes.Agility);
        skills.SetPropertyValue(DefaultSkills.Riding, characteristics.Skills.Riding * 20);
        skills.SetPropertyValue(CrpgSkills.WeaponMaster, characteristics.Skills.WeaponMaster);
        skills.SetPropertyValue(CrpgSkills.MountedArchery, characteristics.Skills.MountedArchery);
        skills.SetPropertyValue(CrpgSkills.Shield, characteristics.Skills.Shield);

        skills.SetPropertyValue(DefaultSkills.OneHanded, characteristics.WeaponProficiencies.OneHanded);
        skills.SetPropertyValue(DefaultSkills.TwoHanded, characteristics.WeaponProficiencies.TwoHanded);
        skills.SetPropertyValue(DefaultSkills.Polearm, characteristics.WeaponProficiencies.Polearm);
        skills.SetPropertyValue(DefaultSkills.Bow, characteristics.WeaponProficiencies.Bow);
        skills.SetPropertyValue(DefaultSkills.Crossbow, characteristics.WeaponProficiencies.Crossbow);
        skills.SetPropertyValue(DefaultSkills.Throwing, characteristics.WeaponProficiencies.Throwing);

        return skills;
    }
#pragma warning restore SA1202

    private Equipment CreateCharacterEquipment(IList<CrpgEquippedItem> equippedItems)
    {
        Equipment equipment = new();
        foreach (var equippedItem in equippedItems)
        {
            var index = ItemSlotToIndex[equippedItem.Slot];
            AddEquipment(equipment, index, equippedItem.UserItem.BaseItemId);
        }

        return equipment;
    }

    private bool DoesEquipmentContainWeapon(Equipment equipment)
    {
        for (var i = EquipmentIndex.WeaponItemBeginSlot; i < EquipmentIndex.ExtraWeaponSlot; i += 1)
        {
            if (!equipment[i].IsEmpty)
            {
                return true;
            }
        }

        return false;
    }

    private void AddEquipment(Equipment equipments, EquipmentIndex idx, string itemId)
    {
        var itemObject = MBObjectManager.Instance.GetObject<ItemObject>(itemId);
        if (itemObject == null)
        {
            Debug.Print($"Cannot equip unknown item '{itemId}'");
            return;
        }

        EquipmentElement equipmentElement = new(itemObject);
        equipments.AddEquipmentToSlotWithoutAgent(idx, equipmentElement);
    }

    private string? CheckIconList(int id)
    {
        foreach (BannerIconGroup bannerIconGroup in BannerManager.Instance.BannerIconGroups)
        {
            if (bannerIconGroup.AllBackgrounds.ContainsKey(id))
            {
                return bannerIconGroup.AllBackgrounds[id];
            }
            else if (bannerIconGroup.AllIcons.ContainsKey(id))
            {
                return bannerIconGroup.AllIcons[id].MaterialName;
            }
        }

        return null;
    }

    private bool TryParseBanner(string bannerKey, out Banner? banner)
    {
        banner = null;

        if (bannerKey.Length > 343)
        {
            Console.WriteLine("Banner key is too long. Max. 343. Actual length: " + bannerKey.Length);
            return false;
        }

        string[] array = bannerKey.Split('.');

        string fixedBannerCode = string.Empty;
        // The maximum size of the banner is Banner.BannerFullSize. But apparently negative values do not cause crashes. Anyway added some checks with tolerance to parse the banner.
        int maxX = 2 * (Banner.BannerFullSize / 2);
        int minX = 2 * -1 * (Banner.BannerFullSize / 2);
        int maxY = maxX;
        int minY = minX;

        /*
         * Format values seperated by dots (.)
         * Icons / Colors found inside of the banner_icons.xml
         * --------
         * iconId
         * colorId
         * colorId2
         * sizeX
         * sizeY
         * posX  (total canvas size is Banner.BannerFullSize but being out of these doesn't seem to cause any issues)
         * posY
         * stroke (0 or 1)
         * mirror (0 or 1)
         * rotation (0-359)
         */

        int iconCounter = 0;
        int num = 0;
        while (num + 10 <= array.Length)
        {
            // 10 is the icon limit. If you try more then 10 icons you won't even spawn.. if you have like 20+ the server might crash.
            if (iconCounter == 10)
            {
                return false;
            }

            if (int.TryParse(array[num], out int iconId))
            {
                if (CheckIconList(iconId) == null)
                {
                    return false;
                }
            }
            else
            {
                return false;
            }

            if (!int.TryParse(array[num + 1], out int colorId1) || !BannerManager.Instance.ReadOnlyColorPalette.ContainsKey(colorId1)
            || !int.TryParse(array[num + 2], out int colorId2) || !BannerManager.Instance.ReadOnlyColorPalette.ContainsKey(colorId2)
            || !int.TryParse(array[num + 3], out int sizeX)
            || !int.TryParse(array[num + 4], out int sizeY)
            || !int.TryParse(array[num + 5], out int posX) || posX > maxX || posX < minX
            || !int.TryParse(array[num + 6], out int posY) || posY > maxY || posY < minY
            || !int.TryParse(array[num + 7], out int drawStroke) || drawStroke > 1 || drawStroke < 0
            || !int.TryParse(array[num + 8], out int mirrior) || mirrior > 1 || mirrior < 0)
            {
                return false;
            }

            if (!int.TryParse(array[num + 9], out int rotation))
            {
                return false;
            }
            else
            {
                rotation %= 360;
                if (rotation < 0)
                {
                    rotation += 360;
                }
            }

            fixedBannerCode += $"{iconId}.{colorId1}.{colorId2}.{sizeX}.{sizeY}.{posX}.{posY}.{drawStroke}.{mirrior}.{rotation}.";
            num += 10;
            iconCounter++;
        }

        if (iconCounter == 0)
        {
            return false;
        }

        if (fixedBannerCode[fixedBannerCode.Length - 1] == '.')
        {
            fixedBannerCode = fixedBannerCode.Substring(0, fixedBannerCode.Length - 1);
        }

        banner = new Banner(fixedBannerCode);
        return true;
    }

    private static readonly Dictionary<CrpgItemSlot, EquipmentIndex> ItemSlotToIndex = new()
    {
        [CrpgItemSlot.Head] = EquipmentIndex.Head,
        [CrpgItemSlot.Shoulder] = EquipmentIndex.Cape,
        [CrpgItemSlot.Body] = EquipmentIndex.Body,
        [CrpgItemSlot.Hand] = EquipmentIndex.Gloves,
        [CrpgItemSlot.Leg] = EquipmentIndex.Leg,
        [CrpgItemSlot.MountHarness] = EquipmentIndex.HorseHarness,
        [CrpgItemSlot.Mount] = EquipmentIndex.Horse,
        [CrpgItemSlot.Weapon0] = EquipmentIndex.Weapon0,
        [CrpgItemSlot.Weapon1] = EquipmentIndex.Weapon1,
        [CrpgItemSlot.Weapon2] = EquipmentIndex.Weapon2,
        [CrpgItemSlot.Weapon3] = EquipmentIndex.Weapon3,
    };
}
